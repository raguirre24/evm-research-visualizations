<!-- keep under 250 lines so itâ€™s portable -->
<!doctype html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>EVM Metrics Interactive Explainer</title>
<link rel="preconnect" href="https://fonts.gstatic.com">
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');
*{box-sizing:border-box;margin:0;padding:0}body{font-family:Inter,Arial,sans-serif;
background:#0f1419;color:#fff;padding:24px}
h1{text-align:center;font-size:2.2rem;margin-bottom:.5rem;
background:linear-gradient(135deg,#667eea,#764ba2);-webkit-background-clip:text;color:transparent}
.subtitle{text-align:center;color:#94a3b8;margin-bottom:2rem}
canvas{width:100%!important;height:100%!important;border-radius:8px}
.grid{display:grid;gap:24px}
@media(min-width:900px){.grid{grid-template-columns:1fr 1fr}}
.card{padding:24px;border:1px solid rgba(255,255,255,.1);
background:rgba(255,255,255,.04);border-radius:20px}
.slider label{display:block;font-size:.85rem;margin-bottom:.35rem;color:#94a3b8}
.slider input{width:100%}
.indic{padding:18px;border-radius:14px;text-align:center}
.indic.good{background:rgba(16,185,129,.12);border:2px solid #10b981}
.indic.warn{background:rgba(245,158,11,.12);border:2px solid #f59e0b}
.indic.bad{background:rgba(239,68,68,.12);border:2px solid #ef4444}
.indic .v{font-size:1.6rem;font-weight:600}
.indic .t{font-size:.8rem;color:#94a3b8}
</style></head><body>
<h1>Earned Value Management Metrics</h1>
<p class="subtitle">Drag the sliders to see how SPI &amp; CPI respond</p>

<div class="grid">
  <section class="card">
    <canvas id="chart"></canvas>
  </section>

  <section class="card">
    <div class="slider"><label>Project progress (%) <span id="pTxt">50</span></label>
      <input type="range" id="p" min="0" max="100" value="50"></div>
    <div class="slider"><label>Schedule offset (%) <span id="sTxt">0</span></label>
      <input type="range" id="s" min="-30" max="30" value="0" step="5"></div>
    <div class="slider"><label>Cost multiplier (%) <span id="cTxt">100</span></label>
      <input type="range" id="c" min="50" max="150" value="100" step="5"></div>

    <div class="grid" style="margin-top:24px">
      <div id="spi" class="indic"><div class="v" id="spiV">1.00</div><div class="t">SPI</div></div>
      <div id="cpi" class="indic"><div class="v" id="cpiV">1.00</div><div class="t">CPI</div></div>
      <div id="sv"  class="indic"><div class="v" id="svV">$0</div><div class="t">SV</div></div>
      <div id="cv"  class="indic"><div class="v" id="cvV">$0</div><div class="t">CV</div></div>
    </div>
  </section>
</div>

<script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
<script>
/* ---------- constants & elements ---------- */
const BAC=1000000,p=document.getElementById('p'),s=document.getElementById('s'),
      c=document.getElementById('c'),pT=pTxt,sT=sTxt,cT=cTxt,
      spiB=spi,cpiB=cpi,svB=sv,cvB=cv;let chart;
function colour(n){return n>=1.1||n>0? '#10b981': n>=.9? '#f59e0b':'#ef4444'}
/* ---------- update ---------- */
function upd(){
 const prog=+p.value,off=+s.value,costM=+c.value/100;
 pT.textContent=prog;sT.textContent=off;cT.textContent=+c.value;
 const evP=Math.max(0,Math.min(100,prog+off));
 const PV=BAC*prog/100, EV=BAC*evP/100, AC=EV*costM;
 const SPI=PV?EV/PV:1, CPI=AC?EV/AC:1, SV=EV-PV, CV=EV-AC;
 spiV.textContent=SPI.toFixed(2);cpiV.textContent=CPI.toFixed(2);
 svV.textContent='$'+Math.round(SV).toLocaleString();
 cvV.textContent='$'+Math.round(CV).toLocaleString();
 [spiB,cpiB].forEach(b=>b.classList.remove('good','warn','bad'));
 spiB.classList.add(SPI>=1.1?'good':SPI>=.9?'warn':'bad');
 cpiB.classList.add(CPI>=1.1?'good':CPI>=.9?'warn':'bad');
 [svB,cvB].forEach(b=>b.classList.add(SV>=50000?'good':SV>=-50000?'warn':'bad'));
 /* redraw */
 const t=[0,prog], pv=[0,PV], ev=[0,EV], ac=[0,AC];
 Plotly.react('chart',[
  {x:t,y:pv,name:'PV',mode:'lines',line:{color:'#667eea',width:3}},
  {x:t,y:ev,name:'EV',mode:'lines',line:{color:'#10b981',width:3}},
  {x:t,y:ac,name:'AC',mode:'lines',line:{color:'#ef4444',width:3}}
 ],{margin:{t:10,l:50,r:20,b:40},xaxis:{title:'Progress %'},
    yaxis:{title:'NZD'},legend:{orientation:'h'}})
}
/* ---------- init ---------- */
Plotly.newPlot('chart',[{x:[0,50],y:[0,500000]}],{});
[p,s,c].forEach(e=>e.addEventListener('input',upd));upd();
</script>
</body></html>
